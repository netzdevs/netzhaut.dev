<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.9.2"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Netzhaut | Web Browser Engine | Patches</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="resize.js"></script>
    <script type="text/javascript" src="navtreedata.js"></script>
    <script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="search/searchdata.js"></script>
    <script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript">
    /* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
      $(document).ready(function() { init_search(); });
    /* @license-end */
    </script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="icon" href="../../logo/favicon.png">
    <link href="../../theme/custom.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>  
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <div style="height: 56px;">
          <div style="left:10px;top:5px;position:absolute;">
            <b>Netzhaut</b>
            <br>
            <b>Web Browser Engine</b>
          </div>
          <div id="projectlogo"><img alt="netzhaut logo" src="../../logo/netzhaut.png"/></div>
          <div style="height:56px;text-align:right;right:10px;top:4px;position:absolute;">
<b>
<!-- NH_MAKE_INSERT_API_VERSION_BEGIN -->
ver.0.2.6.0
<!-- NH_MAKE_INSERT_API_VERSION_END -->
<br>
<!-- NH_MAKE_INSERT_REVISION_BEGIN -->
rev.0.10.56.12
<!-- NH_MAKE_INSERT_REVISION_END -->
</b>
          </div>
        </div>
      </div>
      <div id="titlearea">
        <div class="topnav">
          <a href="../../index.html">Home</a>
          <a href="../../architecture/html/projectlayout.html">Architecture</a>
          <a href="../../design/html/codestyle.html">Design</a>
          <a href="../../internals/html/index.html">Internals</a>
          <a href="../../api/html/modules.html">API</a>
          <a href="../../changelogs/html/index.html">Changelogs</a>
          <a class="active" href="../../patches/html/index.html">Patches</a>
        </div>
      </div>
    </div>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_pages_9751decae0c75ab6611dd1e0a46a8e978affde20.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">9751decae0c75ab6611dd1e0a46a8e978affde20 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p > 

<pre>
From 9751decae0c75ab6611dd1e0a46a8e978affde20 Mon Sep 17 00:00:00 2001
From: Dajo Frey &ltdajo.frey@gmail.com>
Date: Sat, 25 Jun 2022 12:59:52 +0200
Subject: [PATCH] Improve foreground and background rendering.

---
 CHANGELOG.txt                          |   3 +-
 CHANGES.txt                            |   1 +
 build/.nhmake/source.nhmake            |   1 +
 src/bin/nhmake/Changelogs.c            |   2 +-
 src/bin/nhtty/Main.c                   |  14 +-
 src/lib/nhcore/Common/About.h          |   2 +-
 src/lib/nhencoding/Common/About.h      |   2 +-
 src/lib/nhgfx/Common/About.h           |   2 +-
 src/lib/nhgfx/Common/Log.c             |   8 +-
 src/lib/nhterminal/Common/About.h      |   2 +-
 src/lib/nhterminal/OpenGL/Background.c | 187 +++++++++++++++++++++++++
 src/lib/nhterminal/OpenGL/Background.h |  55 ++++++++
 src/lib/nhterminal/OpenGL/Render.c     |  80 ++++++++++-
 src/lib/nhterminal/Terminal/Graphics.c | 164 ++++++++++++++++++----
 src/lib/nhterminal/Terminal/Graphics.h |  25 +++-
 src/lib/nhterminal/Terminal/Grid.c     | 162 ++++++++++++++++-----
 src/lib/nhterminal/Terminal/Grid.h     |  37 +++--
 src/lib/nhterminal/Terminal/Parser.c   |  48 ++++++-
 src/lib/nhterminal/Terminal/Terminal.c |   3 +-
 src/lib/nhtty/Common/About.h           |   2 +-
 src/lib/nhurl/Common/About.h           |   2 +-
 src/lib/nhwsi/Common/About.h           |   2 +-
 22 files changed, 695 insertions(+), 109 deletions(-)
 create mode 100644 CHANGES.txt
 create mode 100644 src/lib/nhterminal/OpenGL/Background.c
 create mode 100644 src/lib/nhterminal/OpenGL/Background.h

diff --git a/CHANGELOG.txt b/CHANGELOG.txt
index dadbfd5..0b25991 100644
--- a/CHANGELOG.txt
+++ b/CHANGELOG.txt
@@ -1,5 +1,4 @@
-changes{date:"2022-06-22"time:"22:33:10"id:"b920fafb920d78c214ca8c3480891d98233d5b21"summary:"Improve OpenGL implementation etc.."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx","nhterminal","nhcore","nhwsi","nhtty","nhurl","nhencoding"}}
-changes{date:"2022-06-22"time:"22:06:11"id:"30546e47debac75e5d4d309929ac1e0479aea975"summary:"Improve OpenGL implementation etc.."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx","nhterminal","nhcore","nhwsi","nhtty","nhurl","nhencoding"}}
+changes{date:"2022-06-22"time:"22:33:10"summary:"Improve OpenGL implementation etc.."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx","nhterminal","nhcore","nhwsi","nhtty","nhurl","nhencoding"}}
 changes{date:"2022-05-29"time:"20:04:45"summary:"Get text rendering kinda working using OpenGL."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx","nhterminal"}}
 changes{date:"2022-05-28"time:"16:07:04"summary:"Partially fix OpenGL implementation."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx","nhterminal"}}
 changes{date:"2022-05-27"time:"16:36:15"summary:"Hopefully fix font-size issue."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"patch"lib:"nhgfx"}}
diff --git a/CHANGES.txt b/CHANGES.txt
new file mode 100644
index 0000000..7fb0a09
--- /dev/null
+++ b/CHANGES.txt
@@ -0,0 +1 @@
+changes{summary:"Improve foreground and background rendering."author{name:"Dajo Frey"contact:"https://github.com/dajofrey"}workload{scope:"minor"lib:"nhterminal"}}
diff --git a/build/.nhmake/source.nhmake b/build/.nhmake/source.nhmake
index 49453d7..fc8380f 100644
--- a/build/.nhmake/source.nhmake
+++ b/build/.nhmake/source.nhmake
@@ -206,6 +206,7 @@ source_lib(
         "Vulkan/Text.c"
         "Vulkan/Render.c"
         "OpenGL/Text.c"
+        "OpenGL/Background.c"
         "OpenGL/Render.c"
         "Common/Result.c"
         "Common/About.c"
diff --git a/src/bin/nhmake/Changelogs.c b/src/bin/nhmake/Changelogs.c
index ed80dc4..b91a756 100644
--- a/src/bin/nhmake/Changelogs.c
+++ b/src/bin/nhmake/Changelogs.c
@@ -81,7 +81,7 @@ static NH_BYTE *writeChangelog(
 static NH_BYTE *writeChangelogIndex(
     nh_make_Runtime *Runtime_p)
 {
-    int length = 255;
+    int length = 1024;
 
     NH_BYTE *data_p = malloc(sizeof(NH_BYTE)*length);
     if (!data_p) {return NULL;}
diff --git a/src/bin/nhtty/Main.c b/src/bin/nhtty/Main.c
index a2f6f79..529b86f 100644
--- a/src/bin/nhtty/Main.c
+++ b/src/bin/nhtty/Main.c
@@ -21,6 +21,7 @@ typedef enum RENDERER {
 
 typedef struct StartUpInput {
     RENDERER renderer;
+    NH_BOOL standardIO;
 } StartUpInput;
 
 static StartUpInput Input;
@@ -43,6 +44,7 @@ static void handleStartUpInput(
     int argc, char **argv_pp)
 {
     Input.renderer = RENDERER_TERMINAL;
+    Input.standardIO = NH_FALSE;
 
     for (int i = 1; i &lt argc; ++i) {
         if (!strcmp(argv_pp[i], "--vulkan")) {
@@ -51,6 +53,9 @@ static void handleStartUpInput(
         if (!strcmp(argv_pp[i], "--opengl")) {
             Input.renderer = RENDERER_OPENGL;
         }
+        if (!strcmp(argv_pp[i], "--stdio")) {
+            Input.standardIO = NH_TRUE;
+        }
     }
 }
 
@@ -76,8 +81,11 @@ int main(int argc, char **argv_pp)
     TTY_p = nh_tty_openTTY();
     if (!TTY_p) {return 1;}
 
-    NH_TTY_RESULT standardIO = Input.renderer ? 1 : nh_tty_claimStandardIO(TTY_p);
-    if (standardIO)
+    if (!Input.renderer || Input.standardIO) {
+        if (nh_tty_claimStandardIO(TTY_p)) {return 1;}
+    }
+
+    if (Input.renderer)
     {
         nh_terminal_Terminal *Terminal_p =  nh_terminal_openTerminal(TTY_p);
         if (!Terminal_p) {return 1;}
@@ -134,7 +142,7 @@ int main(int argc, char **argv_pp)
         if (!nh_keepRunning()) {break;}
     }
 
-    if (!standardIO) {
+    if (!Input.renderer || Input.standardIO) {
         nh_tty_unclaimStandardIO(TTY_p);
     }
 
diff --git a/src/lib/nhcore/Common/About.h b/src/lib/nhcore/Common/About.h
index 93097b7..10dd7a4 100644
--- a/src/lib/nhcore/Common/About.h
+++ b/src/lib/nhcore/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_CORE_PATCH_VERSION 3
+    #define NH_CORE_PATCH_VERSION 2
 
     /**
      * Version array.
diff --git a/src/lib/nhencoding/Common/About.h b/src/lib/nhencoding/Common/About.h
index e77d13c..bac4675 100644
--- a/src/lib/nhencoding/Common/About.h
+++ b/src/lib/nhencoding/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_ENCODING_PATCH_VERSION 2
+    #define NH_ENCODING_PATCH_VERSION 1
 
     /**
      * Version array.
diff --git a/src/lib/nhgfx/Common/About.h b/src/lib/nhgfx/Common/About.h
index 629810f..72a1c1d 100644
--- a/src/lib/nhgfx/Common/About.h
+++ b/src/lib/nhgfx/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_GFX_PATCH_VERSION 5
+    #define NH_GFX_PATCH_VERSION 4
 
     /**
      * Version array.
diff --git a/src/lib/nhgfx/Common/Log.c b/src/lib/nhgfx/Common/Log.c
index 987b245..102f0d9 100644
--- a/src/lib/nhgfx/Common/Log.c
+++ b/src/lib/nhgfx/Common/Log.c
@@ -96,10 +96,10 @@ void nh_gfx_logOpenGLCommand(
 {
 NH_GFX_BEGIN()
 
-    va_list args;
-    va_start(args, format_p);
-    vprintf(format_p, args);
-    va_end(args);
+//    va_list args;
+//    va_start(args, format_p);
+//    vprintf(format_p, args);
+//    va_end(args);
 
 NH_GFX_SILENT_END()
 }
diff --git a/src/lib/nhterminal/Common/About.h b/src/lib/nhterminal/Common/About.h
index 0f02a67..1079e15 100644
--- a/src/lib/nhterminal/Common/About.h
+++ b/src/lib/nhterminal/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_TERMINAL_PATCH_VERSION 5
+    #define NH_TERMINAL_PATCH_VERSION 4
 
     /**
      * Version array.
diff --git a/src/lib/nhterminal/OpenGL/Background.c b/src/lib/nhterminal/OpenGL/Background.c
new file mode 100644
index 0000000..1db591e
--- /dev/null
+++ b/src/lib/nhterminal/OpenGL/Background.c
@@ -0,0 +1,187 @@
+// LICENSE NOTICE ==================================================================================
+
+/**
+ * netzhaut - Web Browser Engine
+ * Copyright (C) 2020 The netzhaut Authors
+ * Published under MIT
+ */
+
+// INCLUDE ========================================================================================
+
+#include "Background.h"
+
+#include "../Terminal/Graphics.h"
+#include "../Common/Macros/Macros.h"
+#include NH_TERMINAL_FLOW
+#include NH_TERMINAL_DEFAULT_CHECK
+
+#include "../../nhgfx/Base/Viewport.h"
+#include "../../nhgfx/Common/Macros/Macros.h"
+#include NH_GFX_FLOW
+#include NH_GFX_CUSTOM_CHECK
+
+#include &ltstdlib.h>
+#include &ltunistd.h>
+#include &lttime.h>
+#include &ltstdio.h>
+#include &ltstring.h>
+#include &ltinttypes.h>
+#include &ltlimits.h>
+#include &ltfloat.h>
+
+// INIT HELPER =====================================================================================
+
+static NH_TERMINAL_RESULT nh_terminal_initOpenGLBackgroundProgram(
+    nh_terminal_OpenGLBackground *OpenGL_p, nh_opengl_CommandBuffer *CommandBuffer_p)
+{
+NH_TERMINAL_BEGIN()
+
+    static const char* vsSource_p =
+        "#version 450\n"
+        "layout(location=0) in vec3 position;\n"
+        "uniform vec3 in_color;\n"
+        "out vec3 color;\n"
+        "void main() {\n"
+        "    color = in_color;\n"
+        "    gl_Position = vec4(position, 1.0);\n"
+        "}\n";
+
+    static const char* fsSource_p =
+        "#version 450\n"
+        "in vec3 color;\n"
+        "out vec4 fragColor;\n"
+        "void main() {\n"
+        "    fragColor = vec4(color, 1.0);\n"
+        "}\n";
+
+    OpenGL_p->VertexShader_p =
+        &nh_opengl_addCommand(CommandBuffer_p, "glCreateShader",
+            nh_opengl_glint(NULL, GL_VERTEX_SHADER))->Result;
+    nh_opengl_addCommand(CommandBuffer_p, "glShaderSource",
+        OpenGL_p->VertexShader_p, nh_opengl_gluint(NULL, 1),
+        nh_opengl_glchar(NULL, NULL, 0, &vsSource_p),
+        nh_opengl_pointer(NULL, NULL));
+    nh_opengl_addCommand(CommandBuffer_p, "glCompileShader", OpenGL_p->VertexShader_p);
+
+    OpenGL_p->FragmentShader_p =
+        &nh_opengl_addCommand(CommandBuffer_p, "glCreateShader",
+            nh_opengl_glint(NULL, GL_FRAGMENT_SHADER))->Result;
+    nh_opengl_addCommand(CommandBuffer_p, "glShaderSource",
+        OpenGL_p->FragmentShader_p, nh_opengl_gluint(NULL, 1),
+        nh_opengl_glchar(NULL, NULL, 0, &fsSource_p),
+        nh_opengl_pointer(NULL, NULL));
+    nh_opengl_addCommand(CommandBuffer_p, "glCompileShader", OpenGL_p->FragmentShader_p);
+
+    OpenGL_p->Program_p = &nh_opengl_addCommand(CommandBuffer_p, "glCreateProgram")->Result;
+
+    nh_opengl_addCommand(CommandBuffer_p, "glAttachShader", OpenGL_p->Program_p,
+        OpenGL_p->VertexShader_p);
+    nh_opengl_addCommand(CommandBuffer_p, "glAttachShader", OpenGL_p->Program_p,
+        OpenGL_p->FragmentShader_p);
+
+    nh_opengl_addCommand(CommandBuffer_p, "glLinkProgram", OpenGL_p->Program_p);
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+}
+
+static NH_TERMINAL_RESULT nh_terminal_initOpenGLBackgroundVertices(
+    nh_terminal_OpenGLBackground *OpenGL_p, nh_opengl_CommandBuffer *CommandBuffer_p)
+{
+NH_TERMINAL_BEGIN()
+
+    OpenGL_p->VertexArray_p = nh_opengl_gluint(NULL, 0);
+    nh_opengl_addCommand(CommandBuffer_p, "glGenVertexArrays", nh_opengl_gluint(NULL, 1),
+        OpenGL_p->VertexArray_p);
+    nh_opengl_addCommand(CommandBuffer_p, "glBindVertexArray", OpenGL_p->VertexArray_p);
+
+    OpenGL_p->IndicesBuffer_p = nh_opengl_gluint(NULL, 0);
+    nh_opengl_addCommand(CommandBuffer_p, "glGenBuffers", nh_opengl_gluint(NULL, 1), 
+        OpenGL_p->IndicesBuffer_p);
+    nh_opengl_addCommand(CommandBuffer_p, "glBindBuffer",
+        nh_opengl_glenum(NULL, GL_ELEMENT_ARRAY_BUFFER), OpenGL_p->IndicesBuffer_p);
+
+    OpenGL_p->VerticesBuffer_p = nh_opengl_gluint(NULL, 0);
+    nh_opengl_addCommand(CommandBuffer_p, "glGenBuffers", nh_opengl_gluint(NULL, 1), 
+        OpenGL_p->VerticesBuffer_p);
+    nh_opengl_addCommand(CommandBuffer_p, "glBindBuffer",
+        nh_opengl_glenum(NULL, GL_ELEMENT_ARRAY_BUFFER), OpenGL_p->VerticesBuffer_p);
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+}
+
+// UPDATE ==========================================================================================
+
+static NH_TERMINAL_RESULT nh_terminal_updateOpenGLBackgroundVertices(
+    nh_terminal_OpenGLBackground *OpenGL_p, nh_opengl_CommandBuffer *CommandBuffer_p, nh_Array *Vertices_p,
+    nh_Array *Indices_p)
+{
+NH_TERMINAL_BEGIN()
+
+    nh_opengl_addCommand(CommandBuffer_p, "glBindVertexArray", OpenGL_p->VertexArray_p);
+
+    // Indices.
+    nh_opengl_addCommand(CommandBuffer_p, "glBindBuffer",
+        nh_opengl_glenum(NULL, GL_ELEMENT_ARRAY_BUFFER), OpenGL_p->IndicesBuffer_p);
+    OpenGL_p->BufferData_p = nh_opengl_addCommand(CommandBuffer_p, "glBufferData",
+        nh_opengl_glenum(NULL, GL_ELEMENT_ARRAY_BUFFER),
+        nh_opengl_glsizeiptr(NULL, Indices_p->length*sizeof(uint32_t)),
+        nh_opengl_glubyte(NULL, Indices_p->p, Indices_p->length*sizeof(uint32_t)),
+        nh_opengl_glenum(NULL, GL_STATIC_DRAW));
+
+    // Vertices.
+    nh_opengl_addCommand(CommandBuffer_p, "glBindBuffer",
+        nh_opengl_glenum(NULL, GL_ARRAY_BUFFER), OpenGL_p->VerticesBuffer_p);
+    nh_opengl_addCommand(CommandBuffer_p, "glBufferData", 
+        nh_opengl_glenum(NULL, GL_ARRAY_BUFFER), 
+        nh_opengl_glsizeiptr(NULL, Vertices_p->length*sizeof(GLfloat)),
+        nh_opengl_glubyte(NULL, Vertices_p->p, Vertices_p->length*sizeof(GLfloat)),
+        nh_opengl_glenum(NULL, GL_STATIC_DRAW));
+
+    nh_opengl_addCommand(CommandBuffer_p, "glEnableVertexAttribArray", nh_opengl_gluint(NULL, 0));
+    nh_opengl_addCommand(CommandBuffer_p, "glVertexAttribPointer",
+        nh_opengl_gluint(NULL, 0), nh_opengl_gluint(NULL, 3), nh_opengl_glenum(NULL, GL_FLOAT),
+        nh_opengl_glboolean(NULL, GL_FALSE), nh_opengl_glsizei(NULL, sizeof(float)*3), 
+        nh_opengl_pointer(NULL, NULL));
+
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
+NH_TERMINAL_RESULT nh_terminal_updateOpenGLBackground(
+    nh_terminal_Graphics *Graphics_p)
+{
+NH_TERMINAL_BEGIN()
+
+    if (Graphics_p->Background.Action.init) {
+        nh_terminal_initOpenGLBackgroundProgram(&Graphics_p->Background.OpenGL, 
+            Graphics_p->Viewport_p->OpenGL.CommandBuffer_p);
+        nh_terminal_initOpenGLBackgroundVertices(&Graphics_p->Background.OpenGL, 
+            Graphics_p->Viewport_p->OpenGL.CommandBuffer_p);
+        Graphics_p->Background.Action.init = NH_FALSE;
+    }
+
+//    if (Graphics_p->Background.Action.updateVertices) {
+        nh_terminal_updateOpenGLBackgroundVertices(&Graphics_p->Background.OpenGL,
+            Graphics_p->Viewport_p->OpenGL.CommandBuffer_p, &Graphics_p->Background.Vertices,
+            &Graphics_p->Background.Indices);
+        Graphics_p->Background.Action.updateVertices = NH_FALSE;
+//    }
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_SUCCESS)
+}
+
+NH_TERMINAL_RESULT nh_terminal_initOpenGLBackground(
+    nh_terminal_OpenGLBackground *Background_p)
+{
+NH_TERMINAL_BEGIN()
+
+    Background_p->VertexShader_p = NULL;
+    Background_p->FragmentShader_p = NULL;
+    Background_p->Program_p = NULL;
+    Background_p->VertexArray_p = NULL;
+    Background_p->IndicesBuffer_p = NULL;
+    Background_p->VerticesBuffer_p = NULL;
+    Background_p->BufferData_p = NULL;
+ 
+NH_TERMINAL_DIAGNOSTIC_END(NH_SUCCESS)
+}
+
diff --git a/src/lib/nhterminal/OpenGL/Background.h b/src/lib/nhterminal/OpenGL/Background.h
new file mode 100644
index 0000000..7e9627b
--- /dev/null
+++ b/src/lib/nhterminal/OpenGL/Background.h
@@ -0,0 +1,55 @@
+#ifndef NH_TERMINAL_OPENGL_BACKGROUND_H
+#define NH_TERMINAL_OPENGL_BACKGROUND_H
+
+#ifndef DOXYGEN_SHOULD_SKIP_THIS
+
+/**
+ * netzhaut - Web Browser Engine
+ * Copyright (C) 2020 The netzhaut Authors
+ * Published under MIT
+ */
+
+#include "../Common/Types/Private.h"
+
+#include "../../nhgfx/OpenGL/CommandBuffer.h"
+#include "../../nhgfx/OpenGL/Commands.h"
+
+#include "../../nhgfx/Fonts/FontManager.h"
+
+#include &ltstdint.h>
+
+typedef struct nh_terminal_Graphics nh_terminal_Graphics;
+
+#endif
+
+/** @addtogroup lib_nhterminal_structs
+ *  @{
+ */
+
+    typedef struct nh_terminal_OpenGLBackground {
+        nh_opengl_Data *VertexShader_p;
+        nh_opengl_Data *FragmentShader_p;
+        nh_opengl_Data *Program_p;
+        nh_opengl_Data *VertexArray_p;
+        nh_opengl_Data *IndicesBuffer_p;
+        nh_opengl_Data *VerticesBuffer_p;
+        nh_opengl_Command *BufferData_p;
+    } nh_terminal_OpenGLBackground;
+
+/** @} */
+
+/** @addtogroup lib_nhterminal_functions
+ *  @{
+ */
+
+    NH_TERMINAL_RESULT nh_terminal_updateOpenGLBackground(
+        nh_terminal_Graphics *Graphics_p
+    );
+
+    NH_TERMINAL_RESULT nh_terminal_initOpenGLBackground(
+        nh_terminal_OpenGLBackground *Background_p
+    );
+
+/** @} */
+
+#endif 
diff --git a/src/lib/nhterminal/OpenGL/Render.c b/src/lib/nhterminal/OpenGL/Render.c
index e6eac21..e7c7d6a 100644
--- a/src/lib/nhterminal/OpenGL/Render.c
+++ b/src/lib/nhterminal/OpenGL/Render.c
@@ -23,9 +23,73 @@
 #include &ltstring.h>
 #include &ltstdio.h>
 
-// TEXT ============================================================================================
+// BACKGROUND ======================================================================================
 
-static NH_TERMINAL_RESULT nh_terminal_drawOpenGLText(
+static NH_TERMINAL_RESULT nh_terminal_drawOpenGLBackground(
+    nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p)
+{
+NH_TERMINAL_BEGIN()
+
+    if (Grid_p->rows &lt= 0 || Grid_p->Rows.size == 0) {
+        NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+    }
+
+    nh_opengl_CommandBuffer *CommandBuffer_p = Graphics_p->Viewport_p->OpenGL.CommandBuffer_p;
+
+    static const GLchar *colorName_p = "in_color";
+    nh_opengl_Data *Color_p = 
+        &nh_opengl_addCommand(CommandBuffer_p, "glGetUniformLocation", Graphics_p->Background.OpenGL.Program_p, 
+            nh_opengl_glchar(NULL, NULL, 0, &colorName_p))->Result;
+
+    int total = 0;
+    int offset = 0;
+    int x = 0;
+    int y = 0;
+
+    nh_terminal_Tile *Tile_p = ((nh_terminal_Tile*)((nh_List*)Grid_p->Rows.pp[0])->pp[0]);
+    nh_Color Color = nh_terminal_isCustomColor(Graphics_p, &Tile_p->Background.Color, NH_FALSE) ? Tile_p->Background.Color : Graphics_p->Background.Color;
+
+    while (NH_TRUE) 
+    {
+        offset += total;
+
+        nh_Color NextColor = Color;
+        total = nh_terminal_getCurrentColorRange(Graphics_p, Grid_p, &NextColor, &x, &y, NH_FALSE) * 6;
+        if (!total) {break;}
+
+        nh_opengl_addCommand(CommandBuffer_p, "glUniform3f", Color_p, nh_opengl_glfloat(NULL, Color.r),
+            nh_opengl_glfloat(NULL, Color.g), nh_opengl_glfloat(NULL, Color.b));
+
+        nh_opengl_addCommand(CommandBuffer_p, "glDrawElements", 
+            nh_opengl_glenum(NULL, GL_TRIANGLES), nh_opengl_glsizei(NULL, total), 
+            nh_opengl_glenum(NULL, GL_UNSIGNED_INT),
+            nh_opengl_pointer(NULL, (void*)(sizeof(uint32_t)*offset)));
+
+        Color = NextColor;
+    }
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+}
+
+static NH_TERMINAL_RESULT nh_terminal_prepareOpenGLBackgroundDraw(
+    nh_terminal_Graphics *Graphics_p)
+{
+NH_TERMINAL_BEGIN()
+
+    nh_opengl_CommandBuffer *CommandBuffer_p = Graphics_p->Viewport_p->OpenGL.CommandBuffer_p;
+
+    nh_opengl_addCommand(CommandBuffer_p, "glEnable", nh_opengl_glenum(NULL, GL_BLEND));
+    nh_opengl_addCommand(CommandBuffer_p, "glBlendFunc", nh_opengl_glenum(NULL, GL_SRC_ALPHA),
+        nh_opengl_glenum(NULL, GL_ONE_MINUS_SRC_ALPHA));
+
+    nh_opengl_addCommand(CommandBuffer_p, "glUseProgram", Graphics_p->Background.OpenGL.Program_p);
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+}
+
+// FOREGROUND ======================================================================================
+
+static NH_TERMINAL_RESULT nh_terminal_drawOpenGLForeground(
     nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p)
 {
 NH_TERMINAL_BEGIN()
@@ -47,7 +111,7 @@ NH_TERMINAL_BEGIN()
     int y = 0;
 
     nh_terminal_Tile *Tile_p = ((nh_terminal_Tile*)((nh_List*)Grid_p->Rows.pp[0])->pp[0]);
-    nh_Color Color = Tile_p->Foreground.custom ? Tile_p->Foreground.Color : Graphics_p->Text.Color;
+    nh_Color Color = nh_terminal_isCustomColor(Graphics_p, &Tile_p->Foreground.Color, NH_TRUE) ? Tile_p->Foreground.Color : Graphics_p->Text.Color;
 
     while (NH_TRUE) 
     {
@@ -71,7 +135,7 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
 }
 
-static NH_TERMINAL_RESULT nh_terminal_prepareOpenGLTextDraw(
+static NH_TERMINAL_RESULT nh_terminal_prepareOpenGLForegroundDraw(
     nh_terminal_Graphics *Graphics_p)
 {
 NH_TERMINAL_BEGIN()
@@ -102,9 +166,13 @@ NH_TERMINAL_BEGIN()
 
     nh_gfx_beginRecording(Graphics_p->Viewport_p);
 
+    NH_TERMINAL_CHECK(nh_terminal_updateOpenGLBackground(Graphics_p))
+    NH_TERMINAL_CHECK(nh_terminal_prepareOpenGLBackgroundDraw(Graphics_p))
+    NH_TERMINAL_CHECK(nh_terminal_drawOpenGLBackground(Graphics_p, Grid_p))
+
     NH_TERMINAL_CHECK(nh_terminal_updateOpenGLText(Graphics_p))
-    NH_TERMINAL_CHECK(nh_terminal_prepareOpenGLTextDraw(Graphics_p))
-    NH_TERMINAL_CHECK(nh_terminal_drawOpenGLText(Graphics_p, Grid_p))
+    NH_TERMINAL_CHECK(nh_terminal_prepareOpenGLForegroundDraw(Graphics_p))
+    NH_TERMINAL_CHECK(nh_terminal_drawOpenGLForeground(Graphics_p, Grid_p))
 
     nh_gfx_endRecording(Graphics_p->Viewport_p);
 
diff --git a/src/lib/nhterminal/Terminal/Graphics.c b/src/lib/nhterminal/Terminal/Graphics.c
index 40c44cb..36fc6fd 100644
--- a/src/lib/nhterminal/Terminal/Graphics.c
+++ b/src/lib/nhterminal/Terminal/Graphics.c
@@ -49,6 +49,19 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
+static nh_terminal_GraphicsAction nh_terminal_initGraphicsAction()
+{
+NH_TERMINAL_BEGIN()
+
+    nh_terminal_GraphicsAction Action;
+
+    Action.init = NH_TRUE;
+    Action.updateFont = NH_TRUE;
+    Action.updateVertices = NH_FALSE;
+
+NH_TERMINAL_END(Action)
+}
+
 NH_TERMINAL_RESULT nh_terminal_initGraphics(
     nh_terminal_Graphics *Graphics_p)
 {
@@ -60,13 +73,11 @@ NH_TERMINAL_BEGIN()
 
     Graphics_p->Text.font = 0;
     Graphics_p->Text.fontSize = 20;
+
+    Graphics_p->Text.Action = nh_terminal_initGraphicsAction();
     Graphics_p->Text.Vertices = nh_initArray(sizeof(float), 1024);
     Graphics_p->Text.Indices  = nh_initArray(sizeof(uint32_t), 1024);
 
-    Graphics_p->Text.Action.init = NH_TRUE;
-    Graphics_p->Text.Action.updateFont = NH_TRUE;
-    Graphics_p->Text.Action.updateVertices = NH_FALSE;
-
     Graphics_p->Text.Color.r = 0.8f;
     Graphics_p->Text.Color.g = 0.8f;
     Graphics_p->Text.Color.b = 0.8f;
@@ -74,11 +85,17 @@ NH_TERMINAL_BEGIN()
 
     nh_terminal_initOpenGLText(&Graphics_p->Text.OpenGL);
 
+    Graphics_p->Background.Action = nh_terminal_initGraphicsAction();
+    Graphics_p->Background.Vertices = nh_initArray(sizeof(float), 1024);
+    Graphics_p->Background.Indices  = nh_initArray(sizeof(uint32_t), 1024);
+
     Graphics_p->Background.Color.r = 0.2f;
     Graphics_p->Background.Color.g = 0.2f;
     Graphics_p->Background.Color.b = 0.2f;
     Graphics_p->Background.Color.a = 1.0f;
 
+    nh_terminal_initOpenGLBackground(&Graphics_p->Background.OpenGL);
+
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
@@ -100,7 +117,40 @@ NH_TERMINAL_BEGIN()
         for (int j = 0; j &lt Row_p->size; ++j) {
             nh_terminal_Tile *Tile_p = Row_p->pp[j];
             if (!Tile_p || !Tile_p->codepoint || Tile_p->codepoint == ' ') {continue;}
-            nh_appendToArray(&Vertices, Tile_p->vertices_p, 20);
+            nh_appendToArray(&Vertices, Tile_p->Foreground.vertices_p, 20);
+            uint32_t indices_p[6] = {offset, offset + 1, offset + 2, offset, offset + 2, offset + 3};
+            nh_appendToArray(&Indices, indices_p, 6);
+            offset += 4;
+        }
+    }
+
+    *Vertices_p = Vertices;
+    *Indices_p = Indices;
+
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
+static NH_TERMINAL_RESULT nh_terminal_getBackgroundData(
+    nh_terminal_Grid *Grid_p, nh_Array *Vertices_p, nh_Array *Indices_p, 
+    nh_terminal_Graphics *Graphics_p)
+{
+NH_TERMINAL_BEGIN()
+
+    nh_Array Vertices = nh_initArray(sizeof(float), 2000);
+    nh_Array Indices = nh_initArray(sizeof(uint32_t), 1024);
+
+    int offset = 0;
+
+    for (int i = 0; i &lt Grid_p->Rows.size; ++i) {
+        nh_List *Row_p = Grid_p->Rows.pp[i];
+
+        for (int j = 0; j &lt Row_p->size; ++j) {
+            nh_terminal_Tile *Tile_p = Row_p->pp[j];
+            if (!nh_terminal_isCustomColor(Graphics_p, &Tile_p->Background.Color, NH_FALSE)) {
+                continue;
+            }
+
+            nh_appendToArray(&Vertices, Tile_p->Background.vertices_p, 12);
             uint32_t indices_p[6] = {offset, offset + 1, offset + 2, offset, offset + 2, offset + 3};
             nh_appendToArray(&Indices, indices_p, 6);
             offset += 4;
@@ -121,9 +171,15 @@ NH_TERMINAL_BEGIN()
     nh_freeArray(&Graphics_p->Text.Vertices);
     nh_freeArray(&Graphics_p->Text.Indices);
 
+    nh_freeArray(&Graphics_p->Background.Vertices);
+    nh_freeArray(&Graphics_p->Background.Indices);
+
     NH_TERMINAL_CHECK(nh_terminal_getTextData(Grid_p, &Graphics_p->Text.Vertices, 
         &Graphics_p->Text.Indices))
 
+    NH_TERMINAL_CHECK(nh_terminal_getBackgroundData(Grid_p, &Graphics_p->Background.Vertices, 
+        &Graphics_p->Background.Indices, Graphics_p))
+
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
@@ -180,7 +236,50 @@ NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 
 // TILE ============================================================================================
 
-NH_TERMINAL_RESULT nh_terminal_getTileCodepointVertices(
+NH_TERMINAL_RESULT nh_terminal_getBackgroundVertices(
+    nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, int col, int row, float vertices_p[12])
+{
+NH_TERMINAL_BEGIN()
+
+    nh_Vertex Vertices_p[4];
+
+    float depth = 0.5f;
+
+    float x = (float)((float)(col * Grid_p->TileSize.width) / (float)Grid_p->Size.width) * 2.0f - 1.0f;
+    float y = (float)((float)(row * Grid_p->TileSize.height) / (float)Grid_p->Size.height) * 2.0f - 1.0f;
+    float width  = (((float)Grid_p->TileSize.width)/((float)Grid_p->Size.width))*2;
+    float height = (((float)Grid_p->TileSize.height)/((float)Grid_p->Size.height))*2;
+
+    float y1 = y;
+    float y2 = y + height;
+
+    if (Graphics_p->Viewport_p->Surface_p->api == NH_GFX_API_OPENGL) {
+        y1 = -y1;
+        y2 = -y2;
+    }
+
+    Vertices_p[0].x = x; 
+    Vertices_p[0].y = y1;
+    Vertices_p[0].z = depth;
+
+    Vertices_p[1].x = x; 
+    Vertices_p[1].y = y2;
+    Vertices_p[1].z = depth;
+
+    Vertices_p[2].x = x + width; 
+    Vertices_p[2].y = y2;
+    Vertices_p[2].z = depth;
+
+    Vertices_p[3].x = x + width; 
+    Vertices_p[3].y = y1;
+    Vertices_p[3].z = depth;
+
+    nh_verticesToArray(Vertices_p, vertices_p, 4, NH_FALSE, 0);
+
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
+NH_TERMINAL_RESULT nh_terminal_getForegroundVertices(
     nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, NH_ENCODING_UTF32 codepoint, int col, 
     int row, float vertices_p[20])
 {
@@ -252,45 +351,59 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
-int nh_terminal_getCurrentColorRange(
-    nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, nh_Color *Current_p, int *x_p,
-    int *y_p, NH_BOOL foreground)
+NH_BOOL nh_terminal_isCustomColor(
+    nh_terminal_Graphics *Graphics_p, nh_Color *Color_p, NH_BOOL foreground)
 {
 NH_TERMINAL_BEGIN()
 
     NH_BOOL custom = NH_FALSE;
 
     if (foreground) {
-        custom = Current_p->r != Graphics_p->Text.Color.r ||
-                 Current_p->g != Graphics_p->Text.Color.g ||
-                 Current_p->b != Graphics_p->Text.Color.b;
+        custom = Color_p->r != Graphics_p->Text.Color.r ||
+                 Color_p->g != Graphics_p->Text.Color.g ||
+                 Color_p->b != Graphics_p->Text.Color.b;
     }
     else {
-        custom = Current_p->r != Graphics_p->Background.Color.r ||
-                 Current_p->g != Graphics_p->Background.Color.g ||
-                 Current_p->b != Graphics_p->Background.Color.b;
+        custom = Color_p->r != Graphics_p->Background.Color.r ||
+                 Color_p->g != Graphics_p->Background.Color.g ||
+                 Color_p->b != Graphics_p->Background.Color.b;
     }
 
+NH_TERMINAL_END(custom)
+}
+
+int nh_terminal_getCurrentColorRange(
+    nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, nh_Color *Current_p, int *x_p,
+    int *y_p, NH_BOOL foreground)
+{
+NH_TERMINAL_BEGIN()
+
+    NH_BOOL custom = nh_terminal_isCustomColor(Graphics_p, Current_p, foreground);
+
     int total = 0;
 
     for (int y = *y_p; y &lt Grid_p->rows; ++y) {
         for (int x = *x_p; x &lt Grid_p->cols; ++x) {
             nh_terminal_Tile *Tile_p = ((nh_terminal_Tile*)((nh_List*)Grid_p->Rows.pp[y])->pp[x]);
-            if (!Tile_p->codepoint || Tile_p->codepoint == ' '){
+            if (foreground && (!Tile_p->codepoint || Tile_p->codepoint == ' ')){
+                continue;
+            }
+            if (!foreground && !nh_terminal_isCustomColor(Graphics_p, &Tile_p->Background.Color, NH_FALSE)) {
                 continue;
             }
             if (foreground) {
-                if (!Tile_p->Foreground.custom && !custom) {
+                NH_BOOL custom2 = nh_terminal_isCustomColor(Graphics_p, &Tile_p->Foreground.Color, foreground);
+                if (!custom2 && !custom) {
                     ++total;
                     continue;
                 }
-                if (!Tile_p->Foreground.custom && custom || Tile_p->Foreground.custom && !custom) {
+                if (!custom2 && custom || custom2 && !custom) {
                     *x_p = x;
                     *y_p = y;
-                    *Current_p = Tile_p->Foreground.custom ? Tile_p->Foreground.Color : Graphics_p->Text.Color;
+                    *Current_p = custom2 ? Tile_p->Foreground.Color : Graphics_p->Text.Color;
                     NH_TERMINAL_END(total)
                 }
-                if (Tile_p->Foreground.custom && custom) {
+                if (custom2 && custom) {
                     if (Tile_p->Foreground.Color.r != Current_p->r || Tile_p->Foreground.Color.g != Current_p->g || 
                         Tile_p->Foreground.Color.b != Current_p->b || Tile_p->Foreground.Color.a != Current_p->a) {
                         *x_p = x;
@@ -303,17 +416,14 @@ NH_TERMINAL_BEGIN()
                 }
             }
             else {
-                if (!Tile_p->Background.custom && !custom) {
-                    ++total;
-                    continue;
-                }
-                if (!Tile_p->Background.custom && custom || Tile_p->Background.custom && !custom) {
+                NH_BOOL custom2 = nh_terminal_isCustomColor(Graphics_p, &Tile_p->Background.Color, foreground);
+                if (custom2 && !custom) {
                     *x_p = x;
                     *y_p = y;
-                    *Current_p = Tile_p->Background.custom ? Tile_p->Background.Color : Graphics_p->Text.Color;
+                    *Current_p = custom2 ? Tile_p->Background.Color : Graphics_p->Background.Color;
                     NH_TERMINAL_END(total)
                 }
-                if (Tile_p->Background.custom && custom) {
+                if (custom2 && custom) {
                     if (Tile_p->Background.Color.r != Current_p->r || Tile_p->Background.Color.g != Current_p->g || 
                         Tile_p->Background.Color.b != Current_p->b || Tile_p->Background.Color.a != Current_p->a) {
                         *x_p = x;
diff --git a/src/lib/nhterminal/Terminal/Graphics.h b/src/lib/nhterminal/Terminal/Graphics.h
index 0eda17a..689ec63 100644
--- a/src/lib/nhterminal/Terminal/Graphics.h
+++ b/src/lib/nhterminal/Terminal/Graphics.h
@@ -13,6 +13,7 @@
 
 #include "../Vulkan/Text.h"
 #include "../OpenGL/Text.h"
+#include "../OpenGL/Background.h"
 
 #endif
 
@@ -20,14 +21,14 @@
  *  @{
  */
 
-    typedef struct nh_terminal_GraphicsTextAction {
+    typedef struct nh_terminal_GraphicsAction {
         NH_BOOL init;
         NH_BOOL updateFont;
         NH_BOOL updateVertices;
-    } nh_terminal_GraphicsTextAction;
+    } nh_terminal_GraphicsAction;
 
     typedef struct nh_terminal_GraphicsText {
-        nh_terminal_GraphicsTextAction Action;
+        nh_terminal_GraphicsAction Action;
         nh_terminal_VulkanText Vulkan;
         nh_terminal_OpenGLText OpenGL;
         nh_Array Vertices;
@@ -39,6 +40,10 @@
     } nh_terminal_GraphicsText;
 
     typedef struct nh_terminal_GraphicsBackground {
+        nh_terminal_GraphicsAction Action;
+        nh_terminal_OpenGLBackground OpenGL;
+        nh_Array Vertices;
+        nh_Array Indices;
         nh_Color Color;
     } nh_terminal_GraphicsBackground;
 
@@ -70,9 +75,17 @@
         nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p
     );
 
-    NH_TERMINAL_RESULT nh_terminal_getTileCodepointVertices(
-        nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, NH_ENCODING_UTF32 codepoint, int col, int row, 
-        float vertices_p[20]
+    NH_TERMINAL_RESULT nh_terminal_getBackgroundVertices(
+        nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, int col, int row, float vertices_p[12]
+    );
+
+    NH_TERMINAL_RESULT nh_terminal_getForegroundVertices(
+        nh_terminal_Graphics *Graphics_p, nh_terminal_Grid *Grid_p, NH_ENCODING_UTF32 codepoint, int col, 
+        int row, float vertices_p[20]
+    );
+
+    NH_BOOL nh_terminal_isCustomColor(
+        nh_terminal_Graphics *Graphics_p, nh_Color *Color_p, NH_BOOL foreground
     );
 
     int nh_terminal_getCurrentColorRange(
diff --git a/src/lib/nhterminal/Terminal/Grid.c b/src/lib/nhterminal/Terminal/Grid.c
index 7b6c96a..4c90dc1 100644
--- a/src/lib/nhterminal/Terminal/Grid.c
+++ b/src/lib/nhterminal/Terminal/Grid.c
@@ -29,21 +29,7 @@
 
 #include &ltstring.h>
 #include &ltstdio.h>
-
-// CURSOR ==========================================================================================
-
-void nh_terminal_resetCursor(
-    nh_terminal_Grid *Grid_p)
-{
-NH_TERMINAL_BEGIN()
-
-    Grid_p->Cursor.x = 0;
-    Grid_p->Cursor.y = 0;
-
-NH_TERMINAL_SILENT_END()
-}
-
-// GRID ============================================================================================
+// INIT ============================================================================================
 
 NH_TERMINAL_RESULT nh_terminal_initGrid(
     nh_terminal_Grid *Grid_p)
@@ -61,41 +47,60 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
-NH_TERMINAL_RESULT nh_terminal_updateGridSize(
-    nh_terminal_Grid *Grid_p, int cols, int rows)
-{
-NH_TERMINAL_BEGIN()
-NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
-}
-
-// INSERT ==========================================================================================
-
-static void nh_terminal_initTile(
-    nh_terminal_Tile *Tile_p)
+static NH_TERMINAL_RESULT nh_terminal_initTile(
+    nh_terminal_Grid *Grid_p, nh_terminal_Graphics *Graphics_p, nh_terminal_Tile *Tile_p)
 {
 NH_TERMINAL_BEGIN()
 
-    Tile_p->Foreground.custom = NH_FALSE;
     Tile_p->Foreground.Color.r = 0;
     Tile_p->Foreground.Color.g = 0;
     Tile_p->Foreground.Color.b = 0;
     Tile_p->Foreground.Color.a = 0;
 
-    Tile_p->Background.custom = NH_FALSE;
     Tile_p->Background.Color.r = 0;
     Tile_p->Background.Color.g = 0;
     Tile_p->Background.Color.b = 0;
     Tile_p->Background.Color.a = 0;
 
+    memset(Tile_p->Foreground.vertices_p, 0, sizeof(float) * 20);
+    memset(Tile_p->Background.vertices_p, 0, sizeof(float) * 12);
+ 
     Tile_p->codepoint = 0;
+    Tile_p->Attributes = nh_initString(8);
+
+    NH_TERMINAL_CHECK(nh_terminal_getBackgroundVertices(
+        Graphics_p, Grid_p, Grid_p->Cursor.x, Grid_p->Cursor.y, Tile_p->Background.vertices_p
+    ))
+ 
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
+// CURSOR ==========================================================================================
+
+void nh_terminal_resetCursor(
+    nh_terminal_Grid *Grid_p)
+{
+NH_TERMINAL_BEGIN()
+
+    Grid_p->Cursor.x = 0;
+    Grid_p->Cursor.y = 0;
+
+NH_TERMINAL_SILENT_END()
+}
 
-    memset(Tile_p->vertices_p, 0, sizeof(float) * 20);
+void nh_terminal_setCursor(
+    nh_terminal_Grid *Grid_p, int x, int y)
+{
+NH_TERMINAL_BEGIN()
+
+    Grid_p->Cursor.x = x;
+    Grid_p->Cursor.y = y;
 
 NH_TERMINAL_SILENT_END()
 }
 
-static nh_terminal_Tile *nh_terminal_getCursorTile(
-    nh_terminal_Grid *Grid_p)
+nh_terminal_Tile *nh_terminal_getCursorTile(
+    nh_terminal_Grid *Grid_p, void *Graphics_p)
 {
 NH_TERMINAL_BEGIN()
 
@@ -120,7 +125,7 @@ NH_TERMINAL_BEGIN()
     if (!Cols_p->pp[Grid_p->Cursor.x]) {
         Cols_p->pp[Grid_p->Cursor.x] = nh_allocate(sizeof(nh_terminal_Tile));
         NH_TERMINAL_CHECK_MEM(NULL, Cols_p->pp[Grid_p->Cursor.x])
-        nh_terminal_initTile(Cols_p->pp[Grid_p->Cursor.x]);
+        NH_TERMINAL_CHECK(NULL, nh_terminal_initTile(Grid_p, Graphics_p, Cols_p->pp[Grid_p->Cursor.x]))
     }
 
 #include NH_TERMINAL_DEFAULT_CHECK
@@ -128,18 +133,20 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(Cols_p->pp[Grid_p->Cursor.x])
 }
 
+// UPDATE ==========================================================================================
+
 NH_TERMINAL_RESULT nh_terminal_insertCodepoint(
     nh_terminal_Grid *Grid_p, void *Graphics_p, NH_ENCODING_UTF32 codepoint)
 {
 NH_TERMINAL_BEGIN()
 
-    nh_terminal_Tile *Tile_p = nh_terminal_getCursorTile(Grid_p);
+    nh_terminal_Tile *Tile_p = nh_terminal_getCursorTile(Grid_p, Graphics_p);
     NH_TERMINAL_CHECK_NULL(Tile_p)
 
     if (Tile_p->codepoint != codepoint) 
     {
-        NH_TERMINAL_CHECK(nh_terminal_getTileCodepointVertices(
-            Graphics_p, Grid_p, codepoint, Grid_p->Cursor.x, Grid_p->Cursor.y, Tile_p->vertices_p
+        NH_TERMINAL_CHECK(nh_terminal_getForegroundVertices(
+            Graphics_p, Grid_p, codepoint, Grid_p->Cursor.x, Grid_p->Cursor.y, Tile_p->Foreground.vertices_p
         ))
         Tile_p->codepoint = codepoint;
     }
@@ -149,3 +156,88 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
+static nh_Color nh_terminal_getColorFromAttributes(
+    nh_terminal_Graphics *Graphics_p, NH_BYTE *p, NH_BOOL foreground)
+{
+NH_TERMINAL_BEGIN()
+
+    nh_Color Color = foreground ? Graphics_p->Text.Color : Graphics_p->Background.Color;
+
+    while (*p) {
+        if ((foreground && *p == '1') || (!foreground && *p == '7')) {
+            ++p;
+            if (*p != ';') {break;}
+            ++p;
+            if (*p != '3') {break;}
+            ++p;
+            switch (*p)
+            {
+                case '1' : 
+                    Color.r = 1.0;
+                    break; 
+                case '2' :
+                    Color.g = 1.0;
+                    break; 
+                case '3' :
+                    Color.r = 1.0;
+                    Color.g = 1.0;
+                    break;
+                case '4' :
+                    Color.b = 1.0;
+                    break;
+                case '5' : break;
+                case '6' : break;
+                case '7' : break;
+                    Color.r = 1.0;
+                    Color.g = 1.0;
+                    Color.b = 1.0;
+                default : break;
+            }
+        }
+        ++p;
+    }
+
+NH_TERMINAL_END(Color)
+}
+ 
+NH_TERMINAL_RESULT nh_terminal_updateGridAttributes(
+    nh_terminal_Grid *Grid_p, void *Graphics_p)
+{
+NH_TERMINAL_BEGIN()
+
+    nh_Color Foreground = ((nh_terminal_Graphics*)Graphics_p)->Text.Color;
+    nh_Color Background = ((nh_terminal_Graphics*)Graphics_p)->Background.Color;
+
+    for (int i = 0; i &lt Grid_p->Rows.size; ++i) {
+        nh_List *Row_p = Grid_p->Rows.pp[i];
+        for (int j = 0; j &lt Row_p->size; ++j) {
+            nh_terminal_Tile *Tile_p = Row_p->pp[j];
+            if (Tile_p->Attributes.length > 0) {
+                Foreground = nh_terminal_getColorFromAttributes(Graphics_p, Tile_p->Attributes.p, NH_TRUE);
+                Background = nh_terminal_getColorFromAttributes(Graphics_p, Tile_p->Attributes.p, NH_FALSE);
+            }
+            Tile_p->Foreground.Color = Foreground;
+            Tile_p->Background.Color = Background;
+        } 
+    }
+
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
+NH_TERMINAL_RESULT nh_terminal_resetGridAttributes(
+    nh_terminal_Grid *Grid_p)
+{
+NH_TERMINAL_BEGIN()
+
+    for (int i = 0; i &lt Grid_p->Rows.size; ++i) {
+        nh_List *Row_p = Grid_p->Rows.pp[i];
+        for (int j = 0; j &lt Row_p->size; ++j) {
+            nh_terminal_Tile *Tile_p = Row_p->pp[j];
+            nh_freeString(&Tile_p->Attributes);
+            Tile_p->Attributes = nh_initString(8);
+        } 
+    }
+
+NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
+}
+
diff --git a/src/lib/nhterminal/Terminal/Grid.h b/src/lib/nhterminal/Terminal/Grid.h
index 7a3deb5..6213f3c 100644
--- a/src/lib/nhterminal/Terminal/Grid.h
+++ b/src/lib/nhterminal/Terminal/Grid.h
@@ -22,16 +22,21 @@
         int y;
     } nh_terminal_Cursor;
 
-    typedef struct nh_terminal_TileColor {
-        NH_BOOL custom;
+    typedef struct nh_terminal_TileForeground {
         nh_Color Color;
-    } nh_terminal_TileColor;
+        float vertices_p[20];
+    } nh_terminal_TileForeground;
+
+    typedef struct nh_terminal_TileBackground {
+        nh_Color Color;
+        float vertices_p[12];
+    } nh_terminal_TileBackground;
 
     typedef struct nh_terminal_Tile {
-        nh_terminal_TileColor Foreground;
-        nh_terminal_TileColor Background;
+        nh_terminal_TileForeground Foreground;
+        nh_terminal_TileBackground Background;
         NH_ENCODING_UTF32 codepoint;
-        float vertices_p[20];
+        nh_String Attributes;
     } nh_terminal_Tile;
 
     typedef struct nh_terminal_Grid {
@@ -53,18 +58,30 @@
         nh_terminal_Grid *Grid_p
     );
 
-    NH_TERMINAL_RESULT nh_terminal_initGrid(
-        nh_terminal_Grid *Grid_p
+    void nh_terminal_setCursor(
+        nh_terminal_Grid *Grid_p, int x, int y
     );
 
-    NH_TERMINAL_RESULT nh_terminal_updateGridSize(
-        nh_terminal_Grid *Grid_p, int cols, int rows
+    nh_terminal_Tile *nh_terminal_getCursorTile(
+        nh_terminal_Grid *Grid_p, void *Graphics_p
+    );
+
+    NH_TERMINAL_RESULT nh_terminal_initGrid(
+        nh_terminal_Grid *Grid_p
     );
 
     NH_TERMINAL_RESULT nh_terminal_insertCodepoint(
         nh_terminal_Grid *Grid_p, void *Graphics_p, NH_ENCODING_UTF32 codepoint
     );
 
+    NH_TERMINAL_RESULT nh_terminal_updateGridAttributes(
+        nh_terminal_Grid *Grid_p, void *Graphics_p
+    );
+
+    NH_TERMINAL_RESULT nh_terminal_resetGridAttributes(
+        nh_terminal_Grid *Grid_p
+    );
+
 /** @} */
 
 #endif 
diff --git a/src/lib/nhterminal/Terminal/Parser.c b/src/lib/nhterminal/Terminal/Parser.c
index 6507624..4376c74 100644
--- a/src/lib/nhterminal/Terminal/Parser.c
+++ b/src/lib/nhterminal/Terminal/Parser.c
@@ -58,12 +58,41 @@ NH_TERMINAL_BEGIN()
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
 
+static NH_TERMINAL_RESULT nh_terminal_handleCUP(
+    nh_terminal_Parser *Parser_p, nh_String *Parameters_p)
+{
+NH_TERMINAL_BEGIN()
+
+    int x = 0;
+    int y = 0;
+
+    if (Parameters_p->length == 0) {
+        nh_terminal_resetCursor(&Parser_p->Terminal_p->Grid);
+        NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+    }
+ 
+    x = atoi(Parameters_p->p);
+
+    int i = 0;
+    NH_BYTE *p = Parameters_p->p;
+    while (*p && *p != ';') {p++;}
+
+    if (*p == ';') {++p;}
+    if (*p) {
+        y = atoi(p);
+    }
+
+    nh_terminal_setCursor(&Parser_p->Terminal_p->Grid, x, y);
+
+NH_TERMINAL_DIAGNOSTIC_END(NH_TERMINAL_SUCCESS)
+}
+
 static NH_TERMINAL_RESULT nh_terminal_parseCSISequence(
     nh_terminal_Parser *Parser_p)
 {
 NH_TERMINAL_BEGIN()
 
-    nh_encoding_UTF32String Parameters = nh_encoding_initUTF32(16);
+    nh_String Parameters = nh_initString(16);
     NH_BOOL DEC = NH_FALSE;
 
     if (*(Parser_p->codepoint_p) == '?') {
@@ -72,23 +101,28 @@ NH_TERMINAL_BEGIN()
     }
 
     while (*(Parser_p->codepoint_p) == ';' || nh_encoding_isASCIIDigit(*(Parser_p->codepoint_p))) {
-        nh_encoding_appendUTF32Codepoint(&Parameters, *(Parser_p->codepoint_p));
+        nh_appendByteToString(&Parameters, *((NH_BYTE*)Parser_p->codepoint_p));
         nh_terminal_advanceParser(Parser_p);
     }
 
     switch (*(Parser_p->codepoint_p))
     {
-        case 'H' : // CUP
-            if (Parameters.length == 0) {
-                nh_terminal_resetCursor(&Parser_p->Terminal_p->Grid);
-            }
+        case 'H' : // CUP (Cursor Position)
+            NH_TERMINAL_CHECK(nh_terminal_handleCUP(Parser_p, &Parameters))
             break;
         case 'l' : // RM
             break;
+        case 'm' : // Character Attributes
+            nh_terminal_Tile *Tile_p = nh_terminal_getCursorTile(&Parser_p->Terminal_p->Grid, &Parser_p->Terminal_p->Graphics);
+            NH_TERMINAL_CHECK_NULL(Tile_p)
+            nh_freeString(&Tile_p->Attributes);
+            Tile_p->Attributes = nh_initString(8);
+            nh_appendToString(&Tile_p->Attributes, Parameters.p, Parameters.length);
+            break;
     }
 
     nh_terminal_advanceParser(Parser_p);
-    nh_encoding_freeUTF32(&Parameters);
+    nh_freeString(&Parameters);
 
 NH_TERMINAL_END(NH_TERMINAL_SUCCESS)
 }
diff --git a/src/lib/nhterminal/Terminal/Terminal.c b/src/lib/nhterminal/Terminal/Terminal.c
index be13a74..b1c1f8b 100644
--- a/src/lib/nhterminal/Terminal/Terminal.c
+++ b/src/lib/nhterminal/Terminal/Terminal.c
@@ -139,6 +139,7 @@ NH_TERMINAL_BEGIN()
 
         nh_encoding_UTF32String String = nh_encoding_decodeUTF8(String_p->p, String_p->length, NULL);
         NH_TERMINAL_CHECK(nh_terminal_parseString(Terminal_p, &String))
+        NH_TERMINAL_CHECK(nh_terminal_updateGridAttributes(&Terminal_p->Grid, &Terminal_p->Graphics))
         nh_encoding_freeUTF32(&String);
 
         Terminal_p->Graphics.Text.Action.updateVertices = NH_TRUE;
@@ -173,7 +174,7 @@ NH_TERMINAL_BEGIN()
             &Terminal_p->Grid))
         NH_TERMINAL_CHECK(NH_SIGNAL_ERROR, nh_terminal_renderGraphics(&Terminal_p->Graphics, 
             &Terminal_p->Grid))
-
+        nh_terminal_resetGridAttributes(&Terminal_p->Grid);
         NH_TERMINAL_END(NH_SIGNAL_OK)
     }
 
diff --git a/src/lib/nhtty/Common/About.h b/src/lib/nhtty/Common/About.h
index 8d1ef4f..6ca74e5 100644
--- a/src/lib/nhtty/Common/About.h
+++ b/src/lib/nhtty/Common/About.h
@@ -62,7 +62,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_TTY_PATCH_VERSION 2
+    #define NH_TTY_PATCH_VERSION 1
 
     /**
      * Version array.
diff --git a/src/lib/nhurl/Common/About.h b/src/lib/nhurl/Common/About.h
index 47857e4..db403e9 100644
--- a/src/lib/nhurl/Common/About.h
+++ b/src/lib/nhurl/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_URL_PATCH_VERSION 2
+    #define NH_URL_PATCH_VERSION 1
 
     /**
      * Version array.
diff --git a/src/lib/nhwsi/Common/About.h b/src/lib/nhwsi/Common/About.h
index a4c2f37..655a7d1 100644
--- a/src/lib/nhwsi/Common/About.h
+++ b/src/lib/nhwsi/Common/About.h
@@ -60,7 +60,7 @@
     /**
      * The patch version is used for bugfixes or non-consequential changes. 
      */
-    #define NH_WSI_PATCH_VERSION 2
+    #define NH_WSI_PATCH_VERSION 1
 
     /**
      * Version array.
-- 
2.35.1


</pre>
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
  <!-- HTML footer for doxygen 1.8.15-->
  <!-- start footer part -->
  <div id="nav-path" class="navpath">
    <!--  -->
    <!-- <li class="footer">Generated by -->
    <!-- <a href="http://www.doxygen.org/index.html"> -->
    <!-- <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li> -->
    <div id="foot"> 
        <a href="https://github.com/netzdevs/netzhaut"><div id="footelem">Open Code Repository</div></a>
        <a href="https://github.com/netzdevs/netzhaut.dev"><div id="footelem">Open Docs Repository</div></a>
        <a href="mailto:contact@netzhaut.dev"><div id="footelem">Send EMail</div></a>
    </div>
</html>
